<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>script</title>
</head>

<body>
    <style>
        #main{
            width: 100vw;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
    </style>


    <div id="main">
        <a href="https://bitinfocharts.com/">
            <img src="/logo-1200.jpeg" style="width: 150px;height:150px; margin-top: -100px; margin-bottom: 20px;">
        </a>
        將下方連結拉至書籤列
        <br>
        <a
            href='javascript:function setScript(e){return new Promise((t,n)=>{if(0==e.length){n();return}let a=e.shift();if(!a){n();return}let i=document.createElement("script");i.onload=()=>{t()},i.onerror=async()=>{await setScript(e)},i.src=a,document.head.appendChild(i)})}function getCoinData(e){let t=["Addresses richer than 1 USD","Addresses richer than 100 USD","Addresses richer than 1,000 USD","Addresses richer than 10,000 USD"],n=["Wealth Distribution Top 10 addesses","Wealth Distribution Top 100 addesses","Wealth Distribution Top 1,000 addesses","Wealth Distribution Top 10,000 addesses"],a={"Date/Time":dayjs().format("YYYY/M/D H:m")};return document.querySelectorAll(e).forEach(e=>{let i=e.parentElement.querySelector("td").innerText;i.indexOf("1/100/1,000/10,000 USD")>-1?e.innerText.split(" / ").forEach((e,n)=>{a[t[n]]=e}):i.indexOf("10/100/1,000/10,000 addesses")>-1?e.innerText.replace(" Total","").split(" / ").forEach((e,t)=>{a[n[t]]=e}):i.indexOf("Price")>-1?a[i]=e.innerText.split("\n")[0]:i&&i.length>0&&(a[i]=e.innerText.replaceAll("\n"," "))}),console.log(a),a}function getExcel(e){let t=new ExcelJS.Workbook;e.forEach(e=>{let n=t.addWorksheet(e.name);n.addTable({name:e.name,ref:"A1",columns:[{name:"key"},{name:"value"}],rows:[]}),Object.entries(e.data).forEach(e=>{e[0].length>0&&e[1].length>0&&n.addRow(e)})}),t.xlsx.writeBuffer().then(e=>{let t=document.createElement("a"),n=new Blob([e],{type:"application/vnd.ms-excel;charset=utf-8;"});t.download=`${dayjs().format("YYYY/M/D H:m")}.xlsx`,t.href=URL.createObjectURL(n),t.click()})}async function init(){if("bitinfocharts.com"!==window.location.host){alert("此程式僅限用於 bitinfocharts"),window.location.href="https://bitinfocharts.com/";return}await setScript(["https://cdnjs.cloudflare.com/ajax/libs/exceljs/4.3.0/exceljs.min.js"]),await setScript(["https://cdn.jsdelivr.net/npm/dayjs@1/dayjs.min.js"]);let e=getCoinData(".coin.c_btc"),t=getCoinData(".coin.c_doge");getExcel([{name:"BTC",data:e},{name:"Dogecoin",data:t},])}init();'>
            bitinfocharts's Script
        </a>

        <br>
        <br>
        <a href="/script.js">原始碼</a>
        <a href="/script.min.js">壓縮後原始碼</a>
    </div>

</body>

</html>